(self.webpackJsonp__wix_thunderbolt_app=self.webpackJsonp__wix_thunderbolt_app||[]).push([[7607],{91338:function(e,t,n){"use strict";n.r(t),n.d(t,{PlatformPubsubSymbol:function(){return r.H},TPA_PUB_SUB_PREFIX:function(){return s.$E},editorPage:function(){return f},name:function(){return r.u},page:function(){return l},stripPubSubPrefix:function(){return s.$H}});var s=n(39013),r=n(6774),i=n(21980),a=n(13487),c=n(56510);const u=(0,c.ff)([r.H],(e=>({getSdkHandlers:()=>({publish(t,n,s,r){e.publish(t,"worker",{eventKey:n,isPersistent:r,eventData:s})},subscribe(t,n,s,r){e.subscribe(t,"worker",{eventKey:n,isPersistent:r},s)},unsubscribe(t,n){e.unsubscribe(t,"worker",n)}})}))),o=(0,c.ff)([r.H],(e=>({pageWillUnmount(){e.clearListenersBesideStubs()}}))),l=e=>{e(r.H).to(s.Xr),e(i.CT).to(u),e(a.j.PageWillUnmountHandler).to(o)},f=l},39013:function(e,t,n){"use strict";n.d(t,{$E:function(){return c},$H:function(){return u},Xr:function(){return o}});var s=n(56510),r=n(21980),i=n(18325);const a={},c="TPA_PUB_SUB_";function u(e){const t=new RegExp(`^${c}`);return e.replace(t,"")}const o=(0,s.ff)([r.ZQ,i.ku],((e,t)=>{function n(e,t){const n={persistentData:[],listeners:{}};return a[e]?a[e][t]||(a[e][t]=n):a[e]={[t]:n},a[e][t]}function s(e){Object.keys(a).forEach((t=>{Object.keys(a[t]).forEach((s=>{const r=n(t,s);Object.entries(r.listeners).forEach((([t,n])=>{Object.keys(n).forEach((n=>{e(n,t)&&delete r.listeners[t][n]}))}))}))}))}return{publish(e,t,s){const r=u(s.eventKey),i=s.isPersistent,a=n(e,r),c=a.listeners;if(Object.entries(c).forEach((([e,n])=>Object.keys(n).forEach((n=>{c[e][n].forEach((e=>e({data:s.eventData,name:r,origin:t})))})))),i){const e=s.eventData;a.persistentData.push({name:r,data:e})}},subscribe(e,s,r,i){const a=u(r.eventKey),c=n(e,a);c.listeners[t]||(c.listeners[t]={}),c.listeners[t][s]?"worker"===s&&c.listeners[t][s].push(i):c.listeners[t][s]=[i],r.isPersistent&&c.persistentData.length&&i({data:c.persistentData[0].data,name:a,origin:s},!0)},unsubscribe(e,t,s){const r=n(e,u(s));Object.keys(r.listeners).forEach((e=>{delete r.listeners[e][t]}))},handleIframeSubscribe(t,n,{eventKey:s,isPersistent:r,callId:i}){this.subscribe(t,n,{eventKey:s,isPersistent:r},((t,r=!1)=>{!function(e,t,n){const s=n.document.getElementById(e);if(!s)return;const r=s.getElementsByTagName("iframe")[0];r&&r.contentWindow&&r.contentWindow.postMessage(JSON.stringify(t),"*")}(n,r?{intent:"TPA_RESPONSE",callId:i,type:"registerEventListener",res:{drain:!0,data:[t]},status:!0,compId:n}:{eventType:s,intent:"addEventListener",params:t},e)}))},clearListenersBesideStubs(){s(((e,n)=>!e.includes("tpapopup")&&!e.includes("tpaWorker")&&n===t&&"masterPage"!==n))},clearListenersByCompId(e){s((t=>t===e))}}}))}}]);
//# sourceMappingURL=https://static.parastorage.com/services/wix-thunderbolt/dist/platformPubsub.e7ced280.chunk.min.js.map